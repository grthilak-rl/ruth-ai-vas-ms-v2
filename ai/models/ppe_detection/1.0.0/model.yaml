# PPE Detection Model Contract
# Version: 1.0.0
# This contract describes the model's capabilities and requirements
# Multi-model PPE detector using YOLOv8

# Contract schema version (required)
contract_schema_version: "1.0.0"

# Model identity (required)
model_id: "ppe_detection"
version: "1.0.0"
display_name: "PPE Detection"
description: "Detects Personal Protective Equipment (PPE) violations using multiple YOLOv8 models"
author: "Ruth AI Team"

# Input specification (required)
input:
  type: "frame"
  format: "raw_bgr"
  min_width: 320
  min_height: 240
  max_width: 4096
  max_height: 4096
  channels: 3

# Output specification (required)
output:
  schema_version: "1.0"
  schema:
    violation_detected:
      type: "boolean"
      description: "True if PPE violation detected"
    violation_type:
      type: "string"
      enum:
        - "ppe_violation"
        - "missing_hardhat"
        - "missing_vest"
        - "missing_goggles"
        - "missing_gloves"
        - "missing_boots"
        - "missing_mask"
        - null
      description: "Type of PPE violation detected"
    severity:
      type: "string"
      enum:
        - "critical"
        - "high"
        - "medium"
        - "low"
      description: "Violation severity level"
    confidence:
      type: "number"
      min: 0.0
      max: 1.0
      description: "Overall detection confidence score"
    detections:
      type: "array"
      description: "Array of PPE detections"
      items:
        type: "object"
        properties:
          item:
            type: "string"
            description: "PPE item name"
          status:
            type: "string"
            enum:
              - "present"
              - "missing"
            description: "PPE item status"
          bbox:
            type: "array"
            items: "number"
            description: "Bounding box [x1, y1, x2, y2]"
          confidence:
            type: "number"
            description: "Detection confidence"
    persons_detected:
      type: "integer"
      description: "Number of persons detected"
    violations:
      type: "array"
      items: "string"
      description: "List of missing PPE items"
    ppe_present:
      type: "array"
      items: "string"
      description: "List of detected PPE items"
    metadata:
      type: "object"
      description: "Additional metadata"

# Hardware compatibility (required)
hardware:
  supports_cpu: true
  supports_gpu: true
  supports_jetson: true
  min_ram_mb: 3072
  min_gpu_memory_mb: 1024

# Performance hints (required)
performance:
  inference_time_hint_ms: 300
  recommended_fps: 3
  max_fps: 10
  recommended_batch_size: 1
  warmup_iterations: 2

# Resource limits (optional but recommended)
limits:
  max_memory_mb: 6144
  inference_timeout_ms: 5000
  preprocessing_timeout_ms: 1000
  postprocessing_timeout_ms: 1000
  max_concurrent_inferences: 2

# Model capabilities (optional)
capabilities:
  supports_batching: false
  supports_async: false
  provides_tracking: false
  confidence_calibrated: false
  provides_bounding_boxes: true
  provides_keypoints: false

# Entry points (optional, defaults shown)
entry_points:
  inference: "inference.py"
